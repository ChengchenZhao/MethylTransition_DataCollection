c16_e1_10=SRR805173
c16_e1_11=SRR805174
c16_e1_12=SRR805175
c16_e1_13=SRR805176
c16_e1_14=SRR805177
c16_e1_15=SRR805178
c16_e1_2=SRR805179
c16_e1_3=SRR805180
c16_e1_4=SRR805181
c16_e1_5=SRR805182
c16_e1_6=SRR805183
c16_e1_7=SRR805184
c16_e1_8=SRR805185
c16_e1_9=SRR805186
c16_e4_1=SRR805187
c16_e4_10=SRR805188
c16_e4_11=SRR805189
c16_e4_2=SRR805190
c16_e4_3=SRR805191
c16_e4_4=SRR805192
c16_e4_5=SRR805193
c16_e4_6=SRR805194
c16_e4_7=SRR805195
c16_e4_8=SRR805196
c16_e4_9=SRR805197
c16_e5_1=SRR805198
c16_e5_10=SRR805199
c16_e5_11=SRR805200
c16_e5_12=SRR805201
c16_e5_13=SRR805202
c16_e5_2=SRR805203
c16_e5_3=SRR805204
c16_e5_4=SRR805205
c16_e5_5=SRR805206
c16_e5_6=SRR805207
c16_e5_7=SRR805208
c16_e5_8=SRR805209
c16_e5_9=SRR805210
c16_e6_1=SRR805211
c16_e6_10=SRR805212
c16_e6_11=SRR805213
c16_e6_12=SRR805214
c16_e6_2=SRR805215
c16_e6_3=SRR805216
c16_e6_4=SRR805217
c16_e6_5=SRR805218
c16_e6_6=SRR805219
c16_e6_7=SRR805220
c16_e6_8=SRR805221
c16_e6_9=SRR805222
c4_e1_1=SRR805223
c4_e1_2=SRR805224
c4_e1_4=SRR805225
c4_e2_1=SRR805226
c4_e2_2=SRR805227
c4_e2_3=SRR805228
c4_e2_4=SRR805229
c4_e3_1=SRR805230
c4_e3_3=SRR805231
c4_e3_4=SRR805232
c4_e4_1=SRR805233
c4_e4_2=SRR805234
c4_e4_3=SRR805235
c4_e4_4=SRR805236
c8_e1_1=SRR805237
c8_e1_2=SRR805238
c8_e1_4=SRR805239
c8_e1_5=SRR805240
c8_e1_6=SRR805241
c8_e1_7=SRR805242
c8_e1_8=SRR805243
c8_e2_1=SRR805244
c8_e2_2=SRR805245
c8_e2_3=SRR805246
c8_e2_4=SRR805247
c8_e2_6=SRR805248
c8_e2_7=SRR805249
c8_e2_8=SRR805250
c8_e5_1=SRR805251
c8_e5_2=SRR805252
c8_e5_3=SRR805253
c8_e5_4=SRR805254
c8_e5_6=SRR805255
c8_e5_7=SRR805256
c8_e5_8=SRR805257
c8_e8_1=SRR805258
c8_e8_2=SRR805259
c8_e8_3=SRR805260
c8_e8_4=SRR805261
c8_e8_6=SRR805262
c8_e8_7=SRR805263
c8_e8_8=SRR805264
e2c_e0_1=SRR805286
e2c_e0_2=SRR805287
e2c_e1_1=SRR805288
e2c_e1_2=SRR805289
e2c_e2_1=SRR805290
e2c_e2_2=SRR805291
e2c_e3_1=SRR805292
e2c_e3_2=SRR805293
eblast_e2_1=SRR805294
eblast_e2_10=SRR805295
eblast_e2_12=SRR805296
eblast_e2_15=SRR805297
eblast_e2_16=SRR805298
eblast_e2_17=SRR805299
eblast_e2_19=SRR805300
eblast_e2_2=SRR805301
eblast_e2_22=SRR805302
eblast_e2_3=SRR805303
eblast_e2_4=SRR805304
eblast_e2_5=SRR805305
eblast_e2_6=SRR805306
eblast_e2_7=SRR805307
eblast_e2_8=SRR805308
eblast_e3_1=SRR805309
eblast_e3_10=SRR805310
eblast_e3_12=SRR805311
eblast_e3_13=SRR805312
eblast_e3_14=SRR805313
eblast_e3_15=SRR805314
eblast_e3_16=SRR805315
eblast_e3_17=SRR805316
eblast_e3_2=SRR805317
eblast_e3_3=SRR805318
eblast_e3_4=SRR805319
eblast_e3_6=SRR805320
eblast_e3_7=SRR805321
eblast_e3_8=SRR805322
eblast_e3_9=SRR805323
eblast_e4_1=SRR805324
eblast_e4_12=SRR805325
eblast_e4_13=SRR805326
eblast_e4_14=SRR805327
eblast_e4_16=SRR805328
eblast_e4_17=SRR805329
eblast_e4_18=SRR805330
eblast_e4_2=SRR805331
eblast_e4_3=SRR805332
eblast_e4_5=SRR805333
eblast_e4_6=SRR805334
eblast_e4_8=SRR805335
eblast_e4_9=SRR805336
l2c_e5_1=SRR805337
l2c_e5_2=SRR805338
l2c_e6_1=SRR805339
l2c_e6_2=SRR805340
l2c_e7_1=SRR805341
l2c_e7_2=SRR805342
l2c_e8_1=SRR805343
l2c_e8_2=SRR805344
l2c_e9_1=SRR805345
l2c_e9_2=SRR805346
lblast_e1_10=SRR805347
lblast_e1_11=SRR805348
lblast_e1_13=SRR805349
lblast_e1_14=SRR805350
lblast_e1_16=SRR805351
lblast_e1_19=SRR805352
lblast_e1_2=SRR805353
lblast_e1_20=SRR805354
lblast_e1_21=SRR805355
lblast_e1_23=SRR805356
lblast_e1_24=SRR805357
lblast_e1_26=SRR805358
lblast_e1_27=SRR805359
lblast_e1_4=SRR805360
lblast_e1_5=SRR805361
lblast_e1_6=SRR805362
lblast_e1_7=SRR805363
lblast_e1_8=SRR805364
lblast_e1_9=SRR805365
lblast_e2_1=SRR805366
lblast_e2_12=SRR805367
lblast_e2_14=SRR805368
lblast_e2_16=SRR805369
lblast_e2_17=SRR805370
lblast_e2_2=SRR805371
lblast_e2_3=SRR805372
lblast_e2_5=SRR805373
lblast_e2_7=SRR805374
lblast_e2_8=SRR805375
lblast_e2_9=SRR805376
m2c_e0_1=SRR805377
m2c_e0_2=SRR805378
m2c_e3_1=SRR805379
m2c_e3_2=SRR805380
m2c_e4_1=SRR805381
m2c_e4_2=SRR805382
m2c_e5_1=SRR805383
m2c_e5_2=SRR805384
m2c_e6_1=SRR805385
m2c_e6_2=SRR805386
m2c_e7_1=SRR805387
m2c_e7_2=SRR805388
mblast_e1_1=SRR805389
mblast_e1_10=SRR805390
mblast_e1_11=SRR805391
mblast_e1_12=SRR805392
mblast_e1_13=SRR805393
mblast_e1_14=SRR805394
mblast_e1_15=SRR805395
mblast_e1_16=SRR805396
mblast_e1_17=SRR805397
mblast_e1_18=SRR805398
mblast_e1_19=SRR805399
mblast_e1_2=SRR805400
mblast_e1_20=SRR805401
mblast_e1_22=SRR805402
mblast_e1_23=SRR805403
mblast_e1_24=SRR805404
mblast_e1_3=SRR805405
mblast_e1_4=SRR805406
mblast_e1_5=SRR805407
mblast_e1_6=SRR805408
mblast_e1_8=SRR805409
mblast_e1_9=SRR805410
mblast_e2_1=SRR805411
mblast_e2_10=SRR805412
mblast_e2_11=SRR805413
mblast_e2_12=SRR805414
mblast_e2_13=SRR805415
mblast_e2_14=SRR805416
mblast_e2_15=SRR805417
mblast_e2_16=SRR805418
mblast_e2_17=SRR805419
mblast_e2_18=SRR805420
mblast_e2_2=SRR805421
mblast_e2_23=SRR805422
mblast_e2_24=SRR805423
mblast_e2_3=SRR805424
mblast_e2_4=SRR805425
mblast_e2_5=SRR805426
mblast_e2_6=SRR805427
mblast_e2_7=SRR805428
mblast_e2_8=SRR805429
mblast_e2_9=SRR805430
mblast_e3_1=SRR805431
mblast_e3_10=SRR805432
mblast_e3_11=SRR805433
mblast_e3_12=SRR805434
mblast_e3_13=SRR805435
mblast_e3_14=SRR805436
mblast_e3_15=SRR805437
mblast_e3_17=SRR805438
mblast_e3_18=SRR805439
mblast_e3_2=SRR805440
mblast_e3_23=SRR805441
mblast_e3_3=SRR805442
mblast_e3_4=SRR805443
mblast_e3_5=SRR805444
mblast_e3_6=SRR805445
mblast_e3_7=SRR805446
mblast_e3_8=SRR805447
mblast_e3_9=SRR805448
zygote_1=SRR805449
zygote_2=SRR805450
zygote_3=SRR805451
zygote_4=SRR805452

hisat2_index=/mnt/Storage/home/zhaochengchen/Data/mm9/mm9
refseq_gtf=/mnt/Storage/home/zhaochengchen/Data/mm9/mm9_refSeqsymbol_new.gtf
refseq_bed=/mnt/Storage/home/zhaochengchen/Data/mm9/mm9.refseq.bed

data_path=/mnt/Storage/home/zhaochengchen/Work/1.MethylTransition/data/GSE45719_mmEmbryo_scRNAseq
log_path=/mnt/Storage/home/zhaochengchen/Work/1.MethylTransition/data/GSE45719_mmEmbryo_scRNAseq/log


for sample in c16_e1_10 c16_e1_11 c16_e1_12 c16_e1_13 c16_e1_14 c16_e1_15 c16_e1_2 c16_e1_3 c16_e1_4 c16_e1_5 c16_e1_6 c16_e1_7 c16_e1_8 c16_e1_9 c16_e4_1 c16_e4_10 c16_e4_11 c16_e4_2 c16_e4_3 c16_e4_4 c16_e4_5 c16_e4_6 c16_e4_7 c16_e4_8 c16_e4_9 c16_e5_1 c16_e5_10 c16_e5_11 c16_e5_12 c16_e5_13 c16_e5_2 c16_e5_3 c16_e5_4 c16_e5_5 c16_e5_6 c16_e5_7 c16_e5_8 c16_e5_9 c16_e6_1 c16_e6_10 c16_e6_11 c16_e6_12 c16_e6_2 c16_e6_3 c16_e6_4 c16_e6_5 c16_e6_6 c16_e6_7 c16_e6_8 c16_e6_9 c4_e1_1 c4_e1_2 c4_e1_4 c4_e2_1 c4_e2_2 c4_e2_3 c4_e2_4 c4_e3_1 c4_e3_3 c4_e3_4 c4_e4_1 c4_e4_2 c4_e4_3 c4_e4_4 c8_e1_1 c8_e1_2 c8_e1_4 c8_e1_5 c8_e1_6 c8_e1_7 c8_e1_8 c8_e2_1 c8_e2_2 c8_e2_3 c8_e2_4 c8_e2_6 c8_e2_7 c8_e2_8 c8_e5_1 c8_e5_2 c8_e5_3 c8_e5_4 c8_e5_6 c8_e5_7 c8_e5_8 c8_e8_1 c8_e8_2 c8_e8_3 c8_e8_4 c8_e8_6 c8_e8_7 c8_e8_8 e2c_e0_1 e2c_e0_2 e2c_e1_1 e2c_e1_2 e2c_e2_1 e2c_e2_2 e2c_e3_1 e2c_e3_2 eblast_e2_1 eblast_e2_10 eblast_e2_12 eblast_e2_15 eblast_e2_16 eblast_e2_17 eblast_e2_19 eblast_e2_2 eblast_e2_22 eblast_e2_3 eblast_e2_4 eblast_e2_5 eblast_e2_6 eblast_e2_7 eblast_e2_8 eblast_e3_1 eblast_e3_10 eblast_e3_12 eblast_e3_13 eblast_e3_14 eblast_e3_15 eblast_e3_16 eblast_e3_17 eblast_e3_2 eblast_e3_3 eblast_e3_4 eblast_e3_6 eblast_e3_7 eblast_e3_8 eblast_e3_9 eblast_e4_1 eblast_e4_12 eblast_e4_13 eblast_e4_14 eblast_e4_16 eblast_e4_17 eblast_e4_18 eblast_e4_2 eblast_e4_3 eblast_e4_5 eblast_e4_6 eblast_e4_8 eblast_e4_9 l2c_e5_1 l2c_e5_2 l2c_e6_1 l2c_e6_2 l2c_e7_1 l2c_e7_2 l2c_e8_1 l2c_e8_2 l2c_e9_1 l2c_e9_2 lblast_e1_10 lblast_e1_11 lblast_e1_13 lblast_e1_14 lblast_e1_16 lblast_e1_19 lblast_e1_2 lblast_e1_20 lblast_e1_21 lblast_e1_23 lblast_e1_24 lblast_e1_26 lblast_e1_27 lblast_e1_4 lblast_e1_5 lblast_e1_6 lblast_e1_7 lblast_e1_8 lblast_e1_9 lblast_e2_1 lblast_e2_12 lblast_e2_14 lblast_e2_16 lblast_e2_17 lblast_e2_2 lblast_e2_3 lblast_e2_5 lblast_e2_7 lblast_e2_8 lblast_e2_9 m2c_e0_1 m2c_e0_2 m2c_e3_1 m2c_e3_2 m2c_e4_1 m2c_e4_2 m2c_e5_1 m2c_e5_2 m2c_e6_1 m2c_e6_2 m2c_e7_1 m2c_e7_2 mblast_e1_1 mblast_e1_10 mblast_e1_11 mblast_e1_12 mblast_e1_13 mblast_e1_14 mblast_e1_15 mblast_e1_16 mblast_e1_17 mblast_e1_18 mblast_e1_19 mblast_e1_2 mblast_e1_20 mblast_e1_22 mblast_e1_23 mblast_e1_24 mblast_e1_3 mblast_e1_4 mblast_e1_5 mblast_e1_6 mblast_e1_8 mblast_e1_9 mblast_e2_1 mblast_e2_10 mblast_e2_11 mblast_e2_12 mblast_e2_13 mblast_e2_14 mblast_e2_15 mblast_e2_16 mblast_e2_17 mblast_e2_18 mblast_e2_2 mblast_e2_23 mblast_e2_24 mblast_e2_3 mblast_e2_4 mblast_e2_5 mblast_e2_6 mblast_e2_7 mblast_e2_8 mblast_e2_9 mblast_e3_1 mblast_e3_10 mblast_e3_11 mblast_e3_12 mblast_e3_13 mblast_e3_14 mblast_e3_15 mblast_e3_17 mblast_e3_18 mblast_e3_2 mblast_e3_23 mblast_e3_3 mblast_e3_4 mblast_e3_5 mblast_e3_6 mblast_e3_7 mblast_e3_8 mblast_e3_9 zygote_1 zygote_2 zygote_3 zygote_4
do
	cd ~/Work/1.MethylTransition/data/GSE45719_mmEmbryo_scRNAseq/
	# fastq-dump ${!sample}.sra
	# mkdir ${sample}
	cd ${sample}
	# cutadapt -q 30 -m 30 -g AAGCAGTGGTATCAACGCAGAGTACATGGG -a "A{100}" -a "T{100}" -o ${sample}_cut.fastq ../${!sample}.fastq

	# nohup hisat2 -p 20 --dta -x ${hisat2_index} -U ${sample}_cut.fastq -S ${sample}.align.sam > ${sample}.align.log 2>&1
	# nohup samtools sort -@ 20 -o ${sample}.bam ${sample}.align.sam > ${sample}.sam_sort.log 2>&1
	nohup /mnt/Storage/home/zhaochengchen/bin/stringtie-1.3.3b/stringtie -e -B -p 20 -G ${refseq_gtf} -o ${sample}.gtf ${sample}.bam > ${sample}.stringtie.log 2>&1
	read_distribution.py -i ${sample}.bam -r ${refseq_bed} > ${log_path}/${sample}.readsDistribution

	rm ${sample}_cut.fastq
	rm ../${!sample}.fastq
	rm ${sample}.align.sam
done


####################################################################################################
##############################   2.1 get mapping infomation               ##########################
##############################   2.2 get read distribution infomation     ##########################
##############################   2.3 gene_expression_matrix               ##########################
##############################   2.4 create gtf_file_path.txt             ##########################
####################################################################################################
cd /mnt/Storage/home/zhaochengchen/Work/1.MethylTransition/data/GSE45719_mmEmbryo_scRNAseq
python2 RNA_seq_preprocessing.py

python2 /mnt/Storage/home/zhaochengchen/Work/1.MethylTransition/data/inhouse_mmEmbryo_scRNAseq/RemoveDuplicateGenes.py merge_fpkm.txt GSE45719_mmEmbryoFPKM.txt

###################################################################
#####################   2.gene_count_matrix   #####################
###################################################################
gtf_file_path=/mnt/Storage/home/zhaochengchen/Work/1.MethylTransition/data/GSE45719_mmEmbryo_scRNAseq/gtf_file_path.txt
path=/mnt/Storage/home/zhaochengchen/Work/1.MethylTransition/data/GSE45719_mmEmbryo_scRNAseq

python2 ~/bin/prepDE.py -i ${gtf_file_path} -g ${path}/gene_count.txt -t ${path}/transcript_count.txt > count_convertion.log 2>&1
sed -i "s/,/\t/g" ${path}/gene_count.txt
sed -i "s/,/\t/g" ${path}/transcript_count.txt

mv ${path}/gene_count.txt ${path}/GSE45719_mmEmbryoCounts.txt